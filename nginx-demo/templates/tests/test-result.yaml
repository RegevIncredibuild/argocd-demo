apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ .Release.Name }}-test-result"
  annotations:
    argocd.argoproj.io/hook: PostSync
    argocd.argoproj.io/hook-delete-policy: HookSucceeded
    argocd.argoproj.io/sync-wave: "2"  # Run after the test
data:
  message: "{{ .Values.message }}"
  test_result: "Application test completed successfully"
  timestamp: "{{ now | date \"2006-01-02T15:04:05Z07:00\" }}"
